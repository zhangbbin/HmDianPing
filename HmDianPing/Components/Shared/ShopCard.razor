@using HmDianPing.Web.Models

<div class="card h-100 shadow-sm">
    <img src="@Shop.Images" class="card-img-top" alt="@Shop.Name" style="height: 200px; object-fit: cover;">

    <div class="card-body">
        <h5 class="card-title fw-bold">@Shop.Name</h5>
        <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="badge bg-warning text-dark">⭐ @Shop.Score 分</span>
            <small class="text-muted">¥@Shop.AvgPrice /人</small>
        </div>
        <p class="card-text text-secondary small">
            <i class="bi bi-geo-alt-fill"></i> @Shop.Area · @Shop.Address
        </p>
    </div>

    <div class="card-footer bg-white border-top-0 d-flex justify-content-between align-items-center">
        <small class="text-muted">@Shop.Comments 条评价</small>

        <div>
            <a href="/shop/@Shop.Id" class="btn btn-outline-primary btn-sm">详情</a>

            <button class="btn btn-outline-danger btn-sm ms-1"
                    @onclick="HandleDeleteClick">
                删除
            </button>
        </div>
    </div>
</div>

@code {
    // 接收参数：必须由父组件传递进来
    // EditorRequired 表示如果父组件不传这个参数，编译器会警告
    [Parameter, EditorRequired]
    public Shop Shop { get; set; } = default!;

    // 定义事件：当点击删除时通知父组件
    // EventCallback<long> 表示我们会带出一个 long 类型的参数（ID）给父组件
    [Parameter]
    public EventCallback<long> OnDeleteClick { get; set; }

    private async Task HandleDeleteClick()
    {
        // 触发事件，把 ID 传出去
        if (OnDeleteClick.HasDelegate)
        {
            await OnDeleteClick.InvokeAsync(Shop.Id);
        }
    }
}
